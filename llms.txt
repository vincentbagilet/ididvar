# ididvar

This package provides tools to easily **identify the identifying
variation in a regression**, specifically in **applied economics**
analyses.

This package is built as part of a [research
project](https://vincentbagilet.github.io/causal_exaggeration/). As
such, the [associated
paper](https://vincentbagilet.github.io/causal_exaggeration/causal_exaggeration_paper.pdf)
provides a detailed scientific description of its content and of its
underpinnings.

**This package is under active development and some functions may not
work perfectly, yet.**

## Installation

You can install the development version of `ididvar` from
[GitHub](https://github.com/vincentbagilet/ididvar) with:

``` r
# install.packages("devtools")
devtools::install_github("vincentbagilet/ididvar")
```

## Usage

Most of the functions of the package take as input the output of a
regression and the name of the variable of interest. `ididvar` supports
a breadth of estimation functions (`lm`,
[`plm::plm`](https://rdrr.io/pkg/plm/man/plm.html),
[`fixest::feols`](https://lrberge.github.io/fixest/reference/feols.html),
`AER::ivreg` for instance).

First, the package provides a straightforward function to compute
identifying variation weights: `idid_weights`.

``` r
library(ididvar)
library(ggplot2)

reg_ex_fixest <- ggplot2::txhousing |>
  dplyr::mutate(l_sales = log(sales)) |> 
  fixest::feols(fml = l_sales ~ median + listings | year + city, vcov = "twoway")

idid_weights(reg_ex_fixest, "median") |>
  head()
#> [1] 1.417497e-05 5.163932e-05 5.908480e-05 1.918702e-06 7.089139e-08
#> [6] 7.372159e-09
```

The package also allows for an effortless exploration of these weights
through visualizations (`idid_viz_weights`, `idid_viz_weights_map`,
`idid_viz_cumul`).

``` r
idid_viz_weights(reg_ex_fixest, "median", year, city, order = "y") +
  ggplot2::labs(x = NULL, y = NULL) 
```

![](reference/figures/README-plot_weights-1.png)

``` r
idid_viz_cumul(reg_ex_fixest, "median")
```

![](reference/figures/README-plot_cumul-1.png)

It also provide functions to identify observations that actually
contribute to identification, in the sense that dropping the other
observations does not significantly affect the estimate obtained
(`idid_viz_contrib`, `idid_viz_contrib_map`, `idid_viz_drop_change`).

``` r
idid_viz_contrib(reg_ex_fixest, "median", var_y = city, order = "y") +
  ggplot2::labs(y = NULL)
```

![](reference/figures/README-plot_contrib-1.png)

The package provides a large [set of
functions](https://vincentbagilet.github.io/ididvar/reference/index.md).
The [Get started
vignette](https://vincentbagilet.github.io/ididvar/articles/ididvar.md)
introduces them in a concise manner, while also describing a typical
workflow for analysis. [Online
appendices](https://vincentbagilet.github.io/causal_exaggeration/ididvar.html)
of the [associated
paper](https://vincentbagilet.github.io/causal_exaggeration/causal_exaggeration_paper.pdf)
complements this vignette by providing an example of a practical
implementation of an analysis using the `ididvar` package.

## Feedback and contributions

Feedback and contributions are more than welcome. If you find a bug or
if the package does not work on your specific case, do not hesitate to
[create a new issue on
Github](https://github.com/vincentbagilet/ididvar/issues/new) or send me
an email at
[vincent.bagilet@ens-lyon.fr](https://vincentbagilet.github.io/ididvar/vincent.bagilet@ens-lyon.fr).

# Package index

## Computation

- [`idid_partial_out()`](https://vincentbagilet.github.io/ididvar/reference/idid_partial_out.md)
  : Partial out controls
- [`idid_weights()`](https://vincentbagilet.github.io/ididvar/reference/idid_weights.md)
  : Compute Identifying Variation Weights
- [`idid_contrib_threshold()`](https://vincentbagilet.github.io/ididvar/reference/idid_contrib_threshold.md)
  : Find a weight threshold below which observations "do not contribute"
- [`idid_contrib_stats()`](https://vincentbagilet.github.io/ididvar/reference/idid_contrib_stats.md)
  : Compute quick descriptive statistics on the effective sample
- [`idid_drop_reg()`](https://vincentbagilet.github.io/ididvar/reference/idid_drop_reg.md)
  : Run the regression with low weight observations dropped
- [`idid_drop_change()`](https://vincentbagilet.github.io/ididvar/reference/idid_drop_change.md)
  : Variation in estimate when dropping low weight observations
- [`idid_grouping_var()`](https://vincentbagilet.github.io/ididvar/reference/idid_grouping_var.md)
  : Compute the between-group variances in weights
- [`idid_to_cf()`](https://vincentbagilet.github.io/ididvar/reference/idid_to_cf.md)
  : Transform an IV regression into its control function equivalent

## Visualization

- [`idid_viz_weights()`](https://vincentbagilet.github.io/ididvar/reference/idid_viz_weights.md)
  : Visualization of Identifying Variation Weights
- [`idid_viz_weights_map()`](https://vincentbagilet.github.io/ididvar/reference/idid_viz_weights_map.md)
  : Plot a map of identifying variation weights
- [`idid_viz_cumul()`](https://vincentbagilet.github.io/ididvar/reference/idid_viz_cumul.md)
  : Visualization of the cumulative distribution of weights
- [`idid_viz_contrib()`](https://vincentbagilet.github.io/ididvar/reference/idid_viz_contrib.md)
  : Visualization of observations contributing (or not) to estimation
- [`idid_viz_contrib_map()`](https://vincentbagilet.github.io/ididvar/reference/idid_viz_contrib_map.md)
  : Plot a map of the effective sample
- [`idid_viz_drop_change()`](https://vincentbagilet.github.io/ididvar/reference/idid_viz_drop_change.md)
  : Visualize changes in point estimate and s.e. when dropping
  observations
- [`idid_viz_bivar()`](https://vincentbagilet.github.io/ididvar/reference/idid_viz_bivar.md)
  : Visualization of the relationship between x and y, after partialling
  out

## Graph theming

- [`theme_idid()`](https://vincentbagilet.github.io/ididvar/reference/theme_idid.md)
  :

  Create a custom theme for `ididvar` visualizations

- [`scale_fill_idid()`](https://vincentbagilet.github.io/ididvar/reference/scale_fill_idid.md)
  [`scale_color_idid()`](https://vincentbagilet.github.io/ididvar/reference/scale_fill_idid.md)
  :

  Create a custom color scale for `ididvar` visualizations

- [`idid_colors_table`](https://vincentbagilet.github.io/ididvar/reference/idid_colors_table.md)
  : A table with the main colors used in base plots in this package

# Articles

### All vignettes

- [Background on the
  weights](https://vincentbagilet.github.io/ididvar/articles/background.md):
- [ididvar](https://vincentbagilet.github.io/ididvar/articles/ididvar.md):
- [Own
  visualizations](https://vincentbagilet.github.io/ididvar/articles/own-viz.md):
- [Specification and
  variation](https://vincentbagilet.github.io/ididvar/articles/specification.md):
