<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Specification and variation • ididvar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Lato-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specification and variation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ididvar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/ididvar.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/background.html">Background on the weights</a></li>
    <li><a class="dropdown-item" href="../articles/own-viz.html">Own visualizations</a></li>
    <li><a class="dropdown-item" href="../articles/specification.html">Specification and variation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Specification and variation</h1>
            
      

      <div class="d-none name"><code>specification.Rmd</code></div>
    </div>

    
    
<p>This document discusses how <code>ididvar</code> can be used to
discuss the impact of specification choices on the identifying variation
weights and their distribution across observations. In particular, it
discusses how the package can provide insights on how different levels
of fixed effects affect the weights and the observations contributing to
identification.</p>
<p>For this example, let’s use the <code>gapminder</code> data set built
on <a href="https://www.gapminder.org/" class="external-link">gapminder.org</a> and made
available by the <a href="https://jennybc.github.io/gapminder/index.html" class="external-link"><code>gapminder</code>
package</a>. It contains data on life expectancy, GDP per-capita and
population, for all countries in the world, every 5 years between 1952
and 2007. It is therefore a panel.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentbagilet.github.io/ididvar/">ididvar</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jennybc/gapminder" class="external-link">gapminder</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lrberge.github.io/fixest/" class="external-link">fixest</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rnaturalearth/" class="external-link">rnaturalearth</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rnaturalearthdata/" class="external-link">rnaturalearthdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></code></pre></div>
<p>In this example, we are interested in studying the relationship
between life expectancy and (log-)GDP per capita. We will consider
several sets of fixed effects and study their impact on the variation
used for identification.</p>
<div class="section level2">
<h2 id="specifications">Specifications<a class="anchor" aria-label="anchor" href="#specifications"></a>
</h2>
<p>Let’s consider 5 regression models: with country, continent, year,
continent-year, and country-year fixed effects. We do not include any
additional controls for simplicity.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder_ext</span> <span class="op">&lt;-</span> <span class="va">gapminder</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>l_gdpPercap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">gdpPercap</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">continent</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Africa"</span>, <span class="st">"Europe"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu">gapminder</span><span class="fu">::</span><span class="va"><a href="https://jennybc.github.io/gapminder/reference/country_codes.html" class="external-link">country_codes</a></span>, by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reg_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder_ext</span>, <span class="va">lifeExp</span> <span class="op">~</span> <span class="va">l_gdpPercap</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reg_continent_fe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder_ext</span>, <span class="va">lifeExp</span> <span class="op">~</span> <span class="va">l_gdpPercap</span> <span class="op">|</span> <span class="va">continent</span>, cluster <span class="op">=</span> <span class="st">"continent"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reg_country_fe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder_ext</span>, <span class="va">lifeExp</span> <span class="op">~</span> <span class="va">l_gdpPercap</span> <span class="op">|</span> <span class="va">country</span>, cluster <span class="op">=</span> <span class="st">"country"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reg_continent_year_fe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder_ext</span>, <span class="va">lifeExp</span> <span class="op">~</span> <span class="va">l_gdpPercap</span> <span class="op">|</span> <span class="va">continent</span><span class="op">^</span><span class="va">year</span>, cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"continent^year"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reg_year_fe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder_ext</span>, <span class="va">lifeExp</span> <span class="op">~</span> <span class="va">l_gdpPercap</span> <span class="op">|</span> <span class="va">year</span>, cluster <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reg_twfe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder_ext</span>, <span class="va">lifeExp</span> <span class="op">~</span> <span class="va">l_gdpPercap</span> <span class="op">|</span> <span class="va">country</span> <span class="op">+</span> <span class="va">year</span>, cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"year"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">regs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  reg_raw <span class="op">=</span> <span class="va">reg_raw</span>, </span>
<span>  reg_continent_fe <span class="op">=</span> <span class="va">reg_continent_fe</span>, </span>
<span>  reg_country_fe <span class="op">=</span> <span class="va">reg_country_fe</span>, </span>
<span>  reg_year_fe <span class="op">=</span> <span class="va">reg_year_fe</span>, </span>
<span>  reg_continent_year_fe <span class="op">=</span> <span class="va">reg_continent_year_fe</span>,</span>
<span>  reg_twfe <span class="op">=</span> <span class="va">reg_twfe</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Of course, the parameter on <code>l_gdpPercap</code> does not
represent the same quantity in each model. In
<code>reg_country_fe</code>, it represents the within country
relationship between <code>lifeExp</code> and <code>l_gdpPercap</code>,
<em>ie</em> comparing observations at different points in time, within a
given country. In <code>reg_year_fe</code>, it represents the within
year and therefore across countries.</p>
<p>The goal of this document is to compare across specification the sets
of observations that contribute to identification.</p>
</div>
<div class="section level2">
<h2 id="bivariate-graphs">Bivariate graphs<a class="anchor" aria-label="anchor" href="#bivariate-graphs"></a>
</h2>
<p>As always in applied econometrics, one the first steps of analysis
consists in exploring the raw data and the relationship between the
variables of interest.</p>
<p>We can thus plot the partialled out versions of the relationships to
get a sense of the variation partialled out by the various sets of fixed
effects. These graphs hopefully help understanding what the fixed
effects how the fixed effects are affecting the relationship of interest
and what variation they are removing. In this particular case,
regardless the set of fixed effects, the relationship is positive,
despite the quantity estimated being somehow radically different.</p>
</div>
<div class="section level2 tabset">
<h2 class="tabset" id="section"></h2>






<ul class="nav nav-tabs" id="section" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#raw" id="raw-tab" type="button" role="tab" aria-controls="raw" aria-selected="true" class="active nav-link">Raw</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#continent-fes" id="continent-fes-tab" type="button" role="tab" aria-controls="continent-fes" aria-selected="false" class="nav-link">Continent FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#country-fes" id="country-fes-tab" type="button" role="tab" aria-controls="country-fes" aria-selected="false" class="nav-link">Country FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#year-fes" id="year-fes-tab" type="button" role="tab" aria-controls="year-fes" aria-selected="false" class="nav-link">Year FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#twfe" id="twfe-tab" type="button" role="tab" aria-controls="twfe" aria-selected="false" class="nav-link">TWFE</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#code" id="code-tab" type="button" role="tab" aria-controls="code" aria-selected="false" class="nav-link">Code</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="raw" role="tabpanel" aria-labelledby="raw-tab">

<pre><code><span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span>
<span><span class="co">#&gt; Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span>
<span><span class="co">#&gt; Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span>
<span><span class="co">#&gt; Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span>
<span><span class="co">#&gt; Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span>
<span><span class="co">#&gt; Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/bivar_raw-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="continent-fes" role="tabpanel" aria-labelledby="continent-fes-tab">

<p><img src="specification_files/figure-html/bivar_continent_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="country-fes" role="tabpanel" aria-labelledby="country-fes-tab">

<p><img src="specification_files/figure-html/bivar_country_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="year-fes" role="tabpanel" aria-labelledby="year-fes-tab">

<p><img src="specification_files/figure-html/bivar_year_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="twfe" role="tabpanel" aria-labelledby="twfe-tab">

<p><img src="specification_files/figure-html/bivar_twfe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="code" role="tabpanel" aria-labelledby="code-tab">

<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph_bivar</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">reg</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/idid_viz_bivar.html">idid_viz_bivar</a></span><span class="op">(</span><span class="va">reg</span>, <span class="st">"l_gdpPercap"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">lims</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">4.2</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">42</span>, <span class="fl">35</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#497C89"</span>, <span class="st">"#cf816b"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">regs</span>, <span class="va">graph_bivar</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="weight-graphs">Weight graphs<a class="anchor" aria-label="anchor" href="#weight-graphs"></a>
</h2>
<p>We then explore how different sets of controls/FEs affect the
distribution of the weights. The heatmap visualization allows to analyze
the contribution of each observation separately and to understand how
the individuals weights vary across specifications.</p>
<p>With country or two-ways FEs for instance, many observations, in the
for the middle of the period have low weight and therefore contribute
little to identification. This is much less the case with year FEs,
although later years contribute more. <strong>The choice of fixed
effects not only affect the estimand but also the weight of
observations</strong> and therefore the set of observations contributing
to identification. In some cases, variation in weights across
specifications may be large for some cluster of observations. For
instance, a particular specification may focus all the weights on a
given set of observations and/or create clusters of low-weight
observations.</p>
</div>
<div class="section level2 tabset">
<h2 class="tabset" id="section-1"></h2>






<ul class="nav nav-tabs" id="section-1" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#raw-1" id="raw-1-tab" type="button" role="tab" aria-controls="raw-1" aria-selected="true" class="active nav-link">Raw</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#continent-fes-1" id="continent-fes-1-tab" type="button" role="tab" aria-controls="continent-fes-1" aria-selected="false" class="nav-link">Continent FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#country-fes-1" id="country-fes-1-tab" type="button" role="tab" aria-controls="country-fes-1" aria-selected="false" class="nav-link">Country FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#year-fes-1" id="year-fes-1-tab" type="button" role="tab" aria-controls="year-fes-1" aria-selected="false" class="nav-link">Year FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#twfe-1" id="twfe-1-tab" type="button" role="tab" aria-controls="twfe-1" aria-selected="false" class="nav-link">TWFE</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#code-1" id="code-1-tab" type="button" role="tab" aria-controls="code-1" aria-selected="false" class="nav-link">Code</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="raw-1" role="tabpanel" aria-labelledby="raw-1-tab">

<pre><code><span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/weights_raw-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="continent-fes-1" role="tabpanel" aria-labelledby="continent-fes-1-tab">

<pre><code><span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/weights_continent_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="country-fes-1" role="tabpanel" aria-labelledby="country-fes-1-tab">

<pre><code><span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/weights_country_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="year-fes-1" role="tabpanel" aria-labelledby="year-fes-1-tab">

<pre><code><span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/weights_year_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="twfe-1" role="tabpanel" aria-labelledby="twfe-1-tab">

<pre><code><span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/weights_twfe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="code-1" role="tabpanel" aria-labelledby="code-1-tab">

<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph_weights</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">reg</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">reg</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/idid_viz_weights.html">idid_viz_weights</a></span><span class="op">(</span><span class="st">"l_gdpPercap"</span>, var_x <span class="op">=</span> <span class="va">year</span>, var_y <span class="op">=</span> <span class="va">country</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">continent</span> <span class="op">~</span> <span class="va">.</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, space <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>      subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"In the"</span>, <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">reg</span><span class="op">)</span><span class="op">)</span>, <span class="st">"model"</span><span class="op">)</span>,</span>
<span>      caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Model:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="va">reg</span><span class="op">$</span><span class="va">call</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      x <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>      y <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">regs</span>, <span class="va">graph_weights</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="contribution-graphs">Contribution graphs<a class="anchor" aria-label="anchor" href="#contribution-graphs"></a>
</h2>
<p>Contribution graphs confirm the previous analyses. They represent
observations that one could drop without changing the point estimate and
standard error by more than a given proportion, <em>se</em> 5%. With
country FEs for instance, not only many observations do not contribute
to estimation but observations that do contribute are disproportionately
located at the beginning and end of the period. This might affects the
external validity of the analysis.</p>
<p>Beyond these external validity concerns, contribution graphs
underline that the effective sample size varies a lot across
specifications. As discussed <a href="https://vincentbagilet.github.io/causal_exaggeration/" class="external-link">in the
research paper</a>, specification choices may affect statistical power
and exaggeration.</p>
</div>
<div class="section level2 tabset">
<h2 class="tabset" id="section-2"></h2>






<ul class="nav nav-tabs" id="section-2" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#raw-2" id="raw-2-tab" type="button" role="tab" aria-controls="raw-2" aria-selected="true" class="active nav-link">Raw</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#continent-fes-2" id="continent-fes-2-tab" type="button" role="tab" aria-controls="continent-fes-2" aria-selected="false" class="nav-link">Continent FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#country-fes-2" id="country-fes-2-tab" type="button" role="tab" aria-controls="country-fes-2" aria-selected="false" class="nav-link">Country FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#year-fes-2" id="year-fes-2-tab" type="button" role="tab" aria-controls="year-fes-2" aria-selected="false" class="nav-link">Year FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#twfe-2" id="twfe-2-tab" type="button" role="tab" aria-controls="twfe-2" aria-selected="false" class="nav-link">TWFE</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#code-2" id="code-2-tab" type="button" role="tab" aria-controls="code-2" aria-selected="false" class="nav-link">Code</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="raw-2" role="tabpanel" aria-labelledby="raw-2-tab">

<pre><code><span><span class="co">#&gt; Searching for the contribution threshold</span></span>
<span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/contrib_raw-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="continent-fes-2" role="tabpanel" aria-labelledby="continent-fes-2-tab">

<pre><code><span><span class="co">#&gt; Searching for the contribution threshold</span></span>
<span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/contrib_continent_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="country-fes-2" role="tabpanel" aria-labelledby="country-fes-2-tab">

<pre><code><span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/contrib_country_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="year-fes-2" role="tabpanel" aria-labelledby="year-fes-2-tab">

<pre><code><span><span class="co">#&gt; Searching for the contribution threshold</span></span>
<span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/contrib_year_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="twfe-2" role="tabpanel" aria-labelledby="twfe-2-tab">

<pre><code><span><span class="co">#&gt; Searching for the contribution threshold</span></span>
<span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/contrib_twfe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="code-2" role="tabpanel" aria-labelledby="code-2-tab">

<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph_contrib</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">reg</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">reg</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/idid_viz_contrib.html">idid_viz_contrib</a></span><span class="op">(</span><span class="st">"l_gdpPercap"</span>, var_x <span class="op">=</span> <span class="va">year</span>, var_y <span class="op">=</span> <span class="va">country</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">continent</span> <span class="op">~</span> <span class="va">.</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, space <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>      caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Model:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="va">reg</span><span class="op">$</span><span class="va">call</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      x <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>      y <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">regs</span>, <span class="va">graph_contrib</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="contribution-sets">Contribution sets<a class="anchor" aria-label="anchor" href="#contribution-sets"></a>
</h2>
<p>The previous visual analysis is confirmed by computing the effective
sample size; it varies strongly with the specification.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">regs</span>, <span class="va">idid_contrib_stats</span>, var_interest <span class="op">=</span> <span class="st">"l_gdpPercap"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>reg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">regs</span><span class="op">)</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">n_effective</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="31%">
<col width="14%">
<col width="14%">
<col width="17%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th align="left">reg</th>
<th align="right">n_initial</th>
<th align="right">n_nominal</th>
<th align="right">n_effective</th>
<th align="right">prop_effective</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">reg_country_fe</td>
<td align="right">984</td>
<td align="right">984</td>
<td align="right">246</td>
<td align="right">0.2500000</td>
</tr>
<tr class="even">
<td align="left">reg_continent_year_fe</td>
<td align="right">984</td>
<td align="right">984</td>
<td align="right">542</td>
<td align="right">0.5508130</td>
</tr>
<tr class="odd">
<td align="left">reg_continent_fe</td>
<td align="right">984</td>
<td align="right">984</td>
<td align="right">689</td>
<td align="right">0.7002033</td>
</tr>
<tr class="even">
<td align="left">reg_year_fe</td>
<td align="right">984</td>
<td align="right">984</td>
<td align="right">689</td>
<td align="right">0.7002033</td>
</tr>
<tr class="odd">
<td align="left">reg_twfe</td>
<td align="right">984</td>
<td align="right">984</td>
<td align="right">788</td>
<td align="right">0.8008130</td>
</tr>
<tr class="even">
<td align="left">reg_raw</td>
<td align="right">984</td>
<td align="right">984</td>
<td align="right">837</td>
<td align="right">0.8506098</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="histograms">Histograms<a class="anchor" aria-label="anchor" href="#histograms"></a>
</h2>
<p>A substantial share of the variation across specifications seem to
come from time. We can explore this further by focusing on this variable
and building histograms instead of heatmaps. As noted above, for country
FEs, most of the contributing observations are located in early and late
periods. In addition, there is a notable pattern with year FEs for
Africa: later years contribute more than earlier years.</p>
</div>
<div class="section level2 tabset">
<h2 class="tabset" id="section-3"></h2>






<ul class="nav nav-tabs" id="section-3" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#raw-3" id="raw-3-tab" type="button" role="tab" aria-controls="raw-3" aria-selected="true" class="active nav-link">Raw</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#continent-fes-3" id="continent-fes-3-tab" type="button" role="tab" aria-controls="continent-fes-3" aria-selected="false" class="nav-link">Continent FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#country-fes-3" id="country-fes-3-tab" type="button" role="tab" aria-controls="country-fes-3" aria-selected="false" class="nav-link">Country FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#year-fes-3" id="year-fes-3-tab" type="button" role="tab" aria-controls="year-fes-3" aria-selected="false" class="nav-link">Year FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#twfe-3" id="twfe-3-tab" type="button" role="tab" aria-controls="twfe-3" aria-selected="false" class="nav-link">TWFE</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#code-3" id="code-3-tab" type="button" role="tab" aria-controls="code-3" aria-selected="false" class="nav-link">Code</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="raw-3" role="tabpanel" aria-labelledby="raw-3-tab">

<pre><code><span><span class="co">#&gt; Searching for the contribution threshold</span></span>
<span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/hist_contrib_raw-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="continent-fes-3" role="tabpanel" aria-labelledby="continent-fes-3-tab">

<pre><code><span><span class="co">#&gt; Searching for the contribution threshold</span></span>
<span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/hist_contrib_continent_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="country-fes-3" role="tabpanel" aria-labelledby="country-fes-3-tab">

<pre><code><span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/hist_contrib_country_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="year-fes-3" role="tabpanel" aria-labelledby="year-fes-3-tab">

<pre><code><span><span class="co">#&gt; Searching for the contribution threshold</span></span>
<span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/hist_contrib_year_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="twfe-3" role="tabpanel" aria-labelledby="twfe-3-tab">

<pre><code><span><span class="co">#&gt; Searching for the contribution threshold</span></span>
<span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/hist_contrib_twfe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="code-3" role="tabpanel" aria-labelledby="code-3-tab">

<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hist_contrib</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">reg</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">reg</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/idid_viz_contrib.html">idid_viz_contrib</a></span><span class="op">(</span><span class="st">"l_gdpPercap"</span>, var_x <span class="op">=</span> <span class="va">year</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">continent</span> <span class="op">~</span> <span class="va">.</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, space <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>      caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Model:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="va">reg</span><span class="op">$</span><span class="va">call</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      x <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>      y <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">regs</span>, <span class="va">hist_contrib</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="maps">Maps<a class="anchor" aria-label="anchor" href="#maps"></a>
</h2>
<p>Since there is also variation across specifications in terms of how
much each country contributes to identification, we can use
<code>idid_viz_map</code> to explore this further. In the country FE
specification, the set of countries that contribute to identification is
limited and not representative of the overall sample.</p>
</div>
<div class="section level2 tabset">
<h2 class="tabset" id="section-4"></h2>






<ul class="nav nav-tabs" id="section-4" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#raw-4" id="raw-4-tab" type="button" role="tab" aria-controls="raw-4" aria-selected="true" class="active nav-link">Raw</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#continent-fes-4" id="continent-fes-4-tab" type="button" role="tab" aria-controls="continent-fes-4" aria-selected="false" class="nav-link">Continent FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#country-fes-4" id="country-fes-4-tab" type="button" role="tab" aria-controls="country-fes-4" aria-selected="false" class="nav-link">Country FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#year-fes-4" id="year-fes-4-tab" type="button" role="tab" aria-controls="year-fes-4" aria-selected="false" class="nav-link">Year FEs</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#twfe-4" id="twfe-4-tab" type="button" role="tab" aria-controls="twfe-4" aria-selected="false" class="nav-link">TWFE</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#code-4" id="code-4-tab" type="button" role="tab" aria-controls="code-4" aria-selected="false" class="nav-link">Code</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="raw-4" role="tabpanel" aria-labelledby="raw-4-tab">

<pre><code><span><span class="co">#&gt; Searching for the contribution threshold</span></span>
<span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/map_contrib_raw-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="continent-fes-4" role="tabpanel" aria-labelledby="continent-fes-4-tab">

<pre><code><span><span class="co">#&gt; Searching for the contribution threshold</span></span>
<span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/map_contrib_continent_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="country-fes-4" role="tabpanel" aria-labelledby="country-fes-4-tab">

<pre><code><span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/map_contrib_country_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="year-fes-4" role="tabpanel" aria-labelledby="year-fes-4-tab">

<pre><code><span><span class="co">#&gt; Searching for the contribution threshold</span></span>
<span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/map_contrib_year_fe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="twfe-4" role="tabpanel" aria-labelledby="twfe-4-tab">

<pre><code><span><span class="co">#&gt; Searching for the contribution threshold</span></span>
<span><span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span></span></code></pre>
<p><img src="specification_files/figure-html/map_contrib_twfe-1.png" width="2187.5"></p>
</div>
<div class="tab-pane" id="code-4" role="tabpanel" aria-labelledby="code-4-tab">

<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">world_sf</span> <span class="op">&lt;-</span> <span class="fu">rnaturalearth</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html" class="external-link">ne_countries</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"medium"</span>, returnclass <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>iso_alpha <span class="op">=</span> <span class="va">adm0_a3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map_contrib</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">reg</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/idid_viz_contrib_map.html">idid_viz_contrib_map</a></span><span class="op">(</span><span class="va">reg</span>, <span class="st">"l_gdpPercap"</span>, <span class="va">world_sf</span>, <span class="st">"iso_alpha"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="st">"+proj=ortho +lon_0=30 +lat_0=28"</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">regs</span>, <span class="va">map_contrib</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Overall, this analysis showed issues of representativity and
effective sample size in the country FEs specification. It invites to
consider the results from this specification carefully.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://vincentbagilet.github.io/" class="external-link">Vincent Bagilet</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
