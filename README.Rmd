---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "70%",
  dpi = 400,
  fig.align = "center"
)
```

# ididvar

<!-- badges: start -->
<!-- badges: end -->

This package provides tools to easily **identify the identifying variation in a regression**, specifically in **applied economics** analyses.

This package is built as part of a [research project](https://vincentbagilet.github.io/causal_exaggeration/). As such, the [associated paper](https://vincentbagilet.github.io/causal_exaggeration/causal_exaggeration_paper.pdf) provides a detailed scientific description of its content and of its underpinnings. 

**This package is under active development and some functions may not work perfectly, yet.**

## Installation

You can install the development version of `ididvar` from [GitHub](https://github.com/vincentbagilet/ididvar) with:

```{r instal, eval=FALSE}
# install.packages("devtools")
devtools::install_github("vincentbagilet/ididvar")
```

## Usage

Most of the functions of the package take as input the output of a regression and the name of the variable of interest. `ididvar` supports a breadth of estimation packages (`lm`, `plm`, `fixest` for instance).

First, the package provides a straightforward function to compute identifying variation weights. 

```{r compute_weights, message=FALSE}
library(ididvar)
library(ggplot2)

reg_ex_fixest <- ggplot2::txhousing |>
  dplyr::mutate(l_sales = log(sales)) |> 
  fixest::feols(fml = l_sales ~ median + listings | year + city, vcov = "twoway")

idid_weights(reg_ex_fixest, "median") |>
  head()
```

The package also allows for an effortless exploration of these weights through visualizations.

```{r plot_weights, message=FALSE, warning=FALSE, fig.asp=1.5, fig.dpi=400}
idid_viz_weights(reg_ex_fixest, "median", year, city, order = "y") +
  ggplot2::labs(x = NULL, y = NULL) 
```

In this particular (somehow silly) regression, most of the identifying variation comes from a few cities: Houston, Dallas, Austin and San Antonio.

```{r plot_cumul, message=FALSE,  warning=FALSE, fig.asp=1.3, fig.dpi=400, out.width='80%'}
idid_viz_cumul(reg_ex_fixest, "median")
```

It also provide functions to identify observations that actually contribute to identification (in the sense that dropping the other observations does not significantly affect the estimate obtained). 

```{r plot_contrib, message=FALSE,  warning=FALSE, fig.asp=1.5, fig.dpi=400}
idid_viz_contrib(reg_ex_fixest, "median", var_y = city, order = "y") +
  ggplot2::labs(y = NULL)
```

The package provides a large [set of functions](reference/index.html). The [Get started vignette](articles/ididvar.html) introduces them in a concise manner, while also describing a typical workflow for analysis. [Online appendices](https://vincentbagilet.github.io/causal_exaggeration/ididvar.html) of the [associated paper](https://vincentbagilet.github.io/causal_exaggeration/causal_exaggeration_paper.pdf) complements this vignette by providing an example of a practical implementation of an analysis using the `ididvar` package. 

## Feedback and contributions

Feedback and contributions are more than welcome. If you find a bug or if the package does not work on your specific case, do not hesitate to [create a new issue on Github](https://github.com/vincentbagilet/ididvar/issues/new) or send me an email at [vincent.bagilet@ens-lyon.fr](vincent.bagilet@ens-lyon.fr).

